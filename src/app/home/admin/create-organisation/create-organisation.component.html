<div class="organisationWrapper">
    <div class="container">
        <div class="organisationForm">
            <h2 class="d-flex align-items-center justify-content-between">{{idEditForm?'Update':'Create'}} Organisation {{idEditForm?'Details':''}}
                <button class="btn" [mat-dialog-close]="true" (click)="closeModel(false)">
                    <mat-icon>close</mat-icon>
                </button>
            </h2>
            <form [formGroup]="createOrgainsationForm">
                <div class="patientCard">
                    <div class="row">
                        <div class="col-12 col-sm-12 col-md- 12 col-lg-12 my-2">
                            <div class="form-group">
                                <mat-label class="control-label">Organisation Name</mat-label>
                                <mat-form-field appearance="outline" class="form-field">
                                    <input matInput placeholder="Organisation name" formControlName="full_name"
                                        autocomplete="off" />
                                </mat-form-field>
                                @if(createOrgainsationForm.get('full_name')?.hasError('required') &&
                                createOrgainsationForm.get('full_name')?.touched){
                                <mat-error class="error-msg mt-2">Organisation Name is required</mat-error>
                                }
                            </div>
                        </div>
                        <div class="col-12 col-sm-12 col-md- 12 col-lg-12 my-2">
                            <div class="form-group">
                                <mat-label class="control-label">Email</mat-label>
                                <mat-form-field appearance="outline" class="form-field">
                                    <input matInput type="email" placeholder="Email" formControlName="email"
                                        autocomplete="off" />
                                </mat-form-field>
                                @if(createOrgainsationForm.get('email')?.hasError('required') &&
                                createOrgainsationForm.get('email')?.touched){
                                <mat-error class="error-msg mt-2">Email is required</mat-error>
                                }
                                @if(createOrgainsationForm.get('email')?.hasError('email') &&
                                createOrgainsationForm.get('email')?.touched){
                                <mat-error class="error-msg mt-2">Invalid Email</mat-error>
                                }

                            </div>
                        </div>
                        <div class="col-6 col-sm-6 col-md-6 col-lg-6 my-2">
                            <div class="form-group">
                                <mat-label class="control-label">Create Password</mat-label>
                                <mat-form-field appearance="outline" class="form-field">
                                    <input matInput type="password" placeholder="Password" formControlName="password"
                                        autocomplete="off" [type]="!isPasswordVisible ? 'password' : 'text'"/>
                                        <mat-icon matSuffix (click)="isPasswordVisible = !isPasswordVisible">{{isPasswordVisible?
                                    'visibility':'visibility_off'}} </mat-icon>
                                </mat-form-field>
                                @if(createOrgainsationForm.get('password')?.hasError('required') &&
                                createOrgainsationForm.get('password')?.touched){
                                <mat-error class="error-msg">Confirm Password is required</mat-error>
                                }
                                @if(createOrgainsationForm.get('password')?.hasError('upp') ||
                                createOrgainsationForm.get('password')?.hasError('lowe') ||
                                createOrgainsationForm.get('password')?.hasError('numb') ||
                                createOrgainsationForm.get('password')?.hasError('speci') &&
                                createOrgainsationForm.get('password')?.touched){
                                <mat-error class="error-msg mt-2">Your password is weak</mat-error>
                                }
                                @if(createOrgainsationForm.get('password')?.hasError('minlength')){
                                <mat-error class="error-msg">Password should be greater than 12 characters!</mat-error>
                                }
                                @if(createOrgainsationForm.get('password')?.hasError('maxlength')){
                                <mat-error class="error-msg">Password can not exceed 20 characters</mat-error>
                                }
                                @if(createOrgainsationForm.get('password')?.hasError('space') &&
                                createOrgainsationForm.get('password')?.touched){
                                <mat-error class="error-msg">Space not allowed</mat-error>
                                }
                            </div>
                        </div>
                        <div class="col-6 col-sm-6 col-md-6 col-lg-6 my-2">
                            <div class="form-group">
                                <mat-label class="control-label">Confirm Password</mat-label>
                                <mat-form-field appearance="outline" class="form-field">
                                    <input matInput type="password" placeholder="Confirm password"
                                        formControlName="cPassword" autocomplete="off" [type]="!isConfirmPasswordVisible ? 'password' : 'text'"  />
                                        <mat-icon matSuffix (click)="isConfirmPasswordVisible = !isConfirmPasswordVisible">{{isConfirmPasswordVisible?
                        'visibility':'visibility_off'}} </mat-icon>
                                </mat-form-field>
                                @if(createOrgainsationForm.get('cPassword')?.hasError('required') &&
                                createOrgainsationForm.get('cPassword')?.touched){
                                <mat-error class="error-msg">Confirm Password is required</mat-error>
                                }
                                @if(createOrgainsationForm.get('cPassword')?.hasError('upp') ||
                                createOrgainsationForm.get('cPassword')?.hasError('lowe') ||
                                createOrgainsationForm.get('cPassword')?.hasError('numb') ||
                                createOrgainsationForm.get('cPassword')?.hasError('speci') &&
                                createOrgainsationForm.get('cPassword')?.touched){
                                <mat-error class="error-msg mt-2">Your password is weak</mat-error>
                                }
                                @if(createOrgainsationForm.get('cPassword')?.hasError('mustMatch') &&
                                createOrgainsationForm.get('cPassword')?.touched){
                                <mat-error class="error-msg">Password & Confirm Password must be same!</mat-error>
                                }
                            </div>
                        </div>
                    </div>
                    <div class="row my-2">
                        <div class="col-12 col-sm-12 col-md-6 col-lg-6">
                            <div class="form-group">
                                <mat-label class="control-label">Country</mat-label>
                                <mat-form-field appearance="outline" class="form-field">
                                    <mat-select formControlName="country" placeholder="Select country">
                                        @for (country of countryList; track $index) {
                                        <mat-option [value]="country?.name">{{country?.name}}</mat-option>
                                        }
                                    </mat-select>
                                </mat-form-field>
                                @if(createOrgainsationForm.get('country')?.hasError('required') &&
                                createOrgainsationForm.get('country')?.touched){
                                <mat-error class="error-msg mt-2">Country is required</mat-error>
                                }
                            </div>
                        </div>
                        <div class="col-12 col-sm-12 col-md-6 col-lg-6">
                            <div class="form-group">
                                <mat-label class="control-label">Phone Number</mat-label>
                                <mat-form-field appearance="outline" class="form-field">
                                    <input matInput placeholder="Phone number" formControlName="contact_no"
                                        autocomplete="off" />
                                </mat-form-field>
                                @if(createOrgainsationForm.get('contact_no')?.hasError('required') &&
                                createOrgainsationForm.get('contact_no')?.touched){
                                <mat-error class="error-msg mt-2">Phone Number is required</mat-error>
                                }
                                @if(createOrgainsationForm.get('contact_no')?.hasError('notNum') &&
                                createOrgainsationForm.get('contact_no')?.touched){
                                <mat-error class="error-msg mt-2">Only Numbers allowed</mat-error>
                                }
                                @if(createOrgainsationForm.get('contact_no')?.hasError('minlength') &&
                                createOrgainsationForm.get('contact_no')?.touched){
                                <mat-error class="error-msg mt-2">Minimum length should be 10 digits</mat-error>
                                }
                                @if(createOrgainsationForm.get('contact_no')?.hasError('maxlength') &&
                                createOrgainsationForm.get('contact_no')?.touched){
                                <mat-error class="error-msg mt-2">Maximum length should be 10 digits</mat-error>
                                }
                            </div>
                        </div>
                    
                    </div>
                    <div class="row my-2">
                        <div class="col-12 col-sm-12 col-md-12 col-lg-12">
                            <mat-label class="control-label">Address</mat-label>
                            <mat-form-field appearance="outline" class="form-field">
                                <textarea matInput placeholder=" Address" formControlName="address" rows="4"></textarea>
                            </mat-form-field>
                            @if(createOrgainsationForm.get('address')?.hasError('required') &&
                            createOrgainsationForm.get('address')?.touched){
                            <mat-error class="error-msg mt-2">Address is required</mat-error>
                            }
                        </div>
                    </div>
                </div>
            </form>

            @if(this.idEditForm){
            <button class="submit-btn btn" (click)=" updateOrganisation()">Update Details</button>
            }@else {
            <button class="submit-btn btn" (click)="createOrganisation()">Save</button>
            }
        </div>
    </div>
</div>