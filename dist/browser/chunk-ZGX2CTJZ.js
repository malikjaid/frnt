import{a as st}from"./chunk-LURNVO4I.js";import{a as ut}from"./chunk-GGWBAYTK.js";import"./chunk-EQQULXW2.js";import{a as Ct}from"./chunk-WG7QQHNH.js";import{F as Z,G as tt,H as et,I as it,J as nt,K as at,L as ot,M as lt,N as rt,O as mt,P as dt,U as _t,V as ct,a as H,c as G,d as j,e as B,g as w,h as J,i as L,j as U,ka as pt,o as q,s as K,t as Q,v as X,y as Y}from"./chunk-7RWZJSZU.js";import"./chunk-RGNDWIHZ.js";import{h as z}from"./chunk-QNDYK3DZ.js";import{q as W}from"./chunk-WLRUUNHX.js";import{Ab as a,Bb as S,Cb as p,Db as s,Fb as v,Kb as P,Mb as u,Sa as V,Ub as o,Va as l,Vb as y,Wb as x,ac as $,ca as b,dc as A,fc as O,ha as M,mb as m,nb as E,ob as _,oc as F,qa as D,ra as h,ub as T,vb as R,xb as N,yb as k,zb as n}from"./chunk-JETHE2PU.js";import"./chunk-DM275RSA.js";function ft(t,i){t&1&&(n(0,"th",31),o(1," Patient Name "),a())}function xt(t,i){if(t&1&&(n(0,"td",32),o(1),a()),t&2){let e=i.$implicit;l(),x(" ",e.patient_name," ")}}function St(t,i){t&1&&(n(0,"th",31),o(1," Patient Id "),a())}function Dt(t,i){if(t&1&&(n(0,"td",32),o(1),a()),t&2){let e=i.$implicit;l(),x(" ",e.patient_id," ")}}function ht(t,i){t&1&&(n(0,"th",31),o(1," Patient Type "),a())}function vt(t,i){if(t&1&&(n(0,"td",32),o(1),a()),t&2){let e=i.$implicit;l(),x(" ",e.type_id===1?"IPD":e.type_id?"OPD":"none"," ")}}function Pt(t,i){t&1&&(n(0,"th",31),o(1," Prompt "),a())}function Tt(t,i){if(t&1&&(n(0,"td",32),o(1),a()),t&2){let e=i.$implicit;l(),x(" ",e.prompt," ")}}function bt(t,i){t&1&&(n(0,"th",31),o(1," Audio "),a())}function wt(t,i){if(t&1&&(n(0,"td",32)(1,"audio",33),S(2,"source",34),a()()),t&2){let e=i.$implicit;l(2),_("src",e.file_url,V)}}function gt(t,i){t&1&&(n(0,"th",31),o(1,"Created Date"),a())}function Et(t,i){if(t&1&&(n(0,"td",32),o(1),A(2,"date"),a()),t&2){let e=i.$implicit;l(),x(" ",O(2,1,e.created_at,"d-MMMM-y")," ")}}function yt(t,i){t&1&&S(0,"tr",35)}function It(t,i){if(t&1&&S(0,"tr",36),t&2){let e=i.$implicit;_("id",e.id)}}function Mt(t,i){if(t&1&&(n(0,"li")(1,"p"),o(2),a(),n(3,"p"),o(4),a()()),t&2){let e=i.$implicit;l(2),y(e.start),l(2),y(e.text)}}function Vt(t,i){if(t&1&&(n(0,"mat-label",37),o(1,"Citation"),a(),n(2,"div",38)(3,"ul"),N(4,Mt,5,2,"li",null,R),a()()),t&2){let e=u(2);l(4),k(e.citations)}}function Rt(t,i){if(t&1){let e=v();n(0,"button",39),P("click",function(){D(e);let r=u(2);return h(r.generateTranscript())}),n(1,"mat-icon",40),o(2,"settings"),a(),o(3," Generate Transcript"),a()}}function Nt(t,i){if(t&1){let e=v();n(0,"button",39),P("click",function(){D(e);let r=u(2);return h(r.generateTranscript())}),n(1,"mat-icon",40),o(2,"settings"),a(),o(3," Generate Summary"),a()}}function kt(t,i){if(t&1){let e=v();n(0,"button",41),P("click",function(){D(e);let r=u(2);return h(r.generateCode())}),n(1,"mat-icon",40),o(2,"settings"),a(),o(3," Generate Code"),a()}}function $t(t,i){t&1&&(n(0,"th",31),o(1," Sr no "),a())}function At(t,i){if(t&1&&(n(0,"td",32),o(1),a()),t&2){let e=i.index;l(),x(" ",e+1," ")}}function Ot(t,i){t&1&&(n(0,"th",31),o(1," Code "),a())}function Ft(t,i){if(t&1&&(n(0,"td",32),o(1),a()),t&2){let e=i.$implicit;l(),x(" ",e.code," ")}}function Wt(t,i){t&1&&(n(0,"th",31),o(1," Citation "),a())}function zt(t,i){if(t&1&&(n(0,"td",32),o(1),a()),t&2){let e=i.$implicit;l(),x(" ",e.description," ")}}function Ht(t,i){t&1&&(n(0,"th",31),o(1,"Action"),a())}function Gt(t,i){if(t&1){let e=v();n(0,"td",32)(1,"mat-radio-group",51),P("change",function(r){let c=D(e).$implicit,f=u(3);return h(f.sendCodeReview(c.id,r))}),n(2,"mat-radio-button",52),o(3,"Ok"),a(),n(4,"mat-radio-button",53),o(5,"Not Ok"),a(),n(6,"mat-radio-button",54),o(7,"Not Sure"),a()()()}if(t&2){let e=i.$implicit;l(),_("value",e.status)}}function jt(t,i){t&1&&(n(0,"th",31),o(1,"Review"),a())}function Bt(t,i){if(t&1){let e=v();n(0,"td",32)(1,"textarea",55),P("keydown.enter",function(r){let c=D(e).$implicit,f=u(3);return h(f.sendCodeReviewType(c.id,r))}),a()()}if(t&2){let e=i.$implicit;l(),_("value",e.reviewer?e.reviewer:null)}}function Jt(t,i){if(t&1&&(n(0,"tr",56)(1,"td",57),o(2," No Data Available."),a()()),t&2){let e=u(3);l(),E("colspan",e.codeTableColumn.length)}}function Lt(t,i){t&1&&S(0,"tr",35)}function Ut(t,i){if(t&1&&S(0,"tr",36),t&2){let e=i.$implicit;_("id",e.id)}}function qt(t,i){if(t&1){let e=v();n(0,"div",29)(1,"div",42)(2,"h5"),o(3,"CPT Codes"),a(),n(4,"button",43),P("click",function(){D(e);let r=u(2);return h(r.addNewCodes("cpt"))}),n(5,"mat-icon"),o(6,"add"),a(),o(7," Add CPT Codes"),a()(),n(8,"table",44),p(9,45),m(10,$t,2,0,"th",5)(11,At,2,1,"td",6),s(),p(12,46),m(13,Ot,2,0,"th",5)(14,Ft,2,1,"td",6),s(),p(15,47),m(16,Wt,2,0,"th",5)(17,zt,2,1,"td",6),s(),p(18,48),m(19,Ht,2,0,"th",5)(20,Gt,8,1,"td",6),s(),p(21,49),m(22,jt,2,0,"th",5)(23,Bt,2,1,"td",6),s(),p(24),m(25,Jt,3,1,"tr",50),s(),m(26,Lt,1,0,"tr",12)(27,Ut,1,1,"tr",13),a()()}if(t&2){let e=u(2);l(8),_("dataSource",e.CPTCodes),l(18),_("matHeaderRowDef",e.codeTableColumn),l(),_("matRowDefColumns",e.codeTableColumn)}}function Kt(t,i){t&1&&(n(0,"th",31),o(1," Sr no "),a())}function Qt(t,i){if(t&1&&(n(0,"td",32),o(1),a()),t&2){let e=i.index;l(),x(" ",e+1," ")}}function Xt(t,i){t&1&&(n(0,"th",31),o(1," Code "),a())}function Yt(t,i){if(t&1&&(n(0,"td",32),o(1),a()),t&2){let e=i.$implicit;l(),x(" ",e.code," ")}}function Zt(t,i){t&1&&(n(0,"th",31),o(1," Citation "),a())}function te(t,i){if(t&1&&(n(0,"td",32),o(1),a()),t&2){let e=i.$implicit;l(),x(" ",e.description," ")}}function ee(t,i){t&1&&(n(0,"th",31),o(1,"Action"),a())}function ie(t,i){if(t&1){let e=v();n(0,"td",32)(1,"mat-radio-group",51),P("change",function(r){let c=D(e).$implicit,f=u(3);return h(f.sendCodeReview(c.id,r))}),n(2,"mat-radio-button",52),o(3,"Ok"),a(),n(4,"mat-radio-button",53),o(5,"Not Ok"),a(),n(6,"mat-radio-button",54),o(7,"Not Sure"),a()()()}if(t&2){let e=i.$implicit;l(),_("value",e.status?e.status:null)}}function ne(t,i){t&1&&(n(0,"th",31),o(1,"Review"),a())}function ae(t,i){if(t&1){let e=v();n(0,"td",32)(1,"textarea",55),P("keydown.enter",function(r){let c=D(e).$implicit,f=u(3);return h(f.sendCodeReviewType(c.id,r))}),a()()}if(t&2){let e=i.$implicit;l(),_("value",e.reviewer?e.reviewer:null)}}function oe(t,i){if(t&1&&(n(0,"tr",56)(1,"td",57),o(2," No Data Available."),a()()),t&2){let e=u(3);l(),E("colspan",e.codeTableColumn.length)}}function le(t,i){t&1&&S(0,"tr",35)}function re(t,i){if(t&1&&S(0,"tr",36),t&2){let e=i.$implicit;_("id",e.id)}}function me(t,i){if(t&1){let e=v();n(0,"div",30)(1,"div",42)(2,"h5"),o(3,"ICD Codes"),a(),n(4,"button",43),P("click",function(){D(e);let r=u(2);return h(r.addNewCodes("icd"))}),n(5,"mat-icon"),o(6,"add"),a(),o(7," Add ICD Codes"),a()(),n(8,"table",58),p(9,45),m(10,Kt,2,0,"th",5)(11,Qt,2,1,"td",6),s(),p(12,46),m(13,Xt,2,0,"th",5)(14,Yt,2,1,"td",6),s(),p(15,47),m(16,Zt,2,0,"th",5)(17,te,2,1,"td",6),s(),p(18,48),m(19,ee,2,0,"th",5)(20,ie,8,1,"td",6),s(),p(21,49),m(22,ne,2,0,"th",5)(23,ae,2,1,"td",6),s(),p(24),m(25,oe,3,1,"tr",50),s(),m(26,le,1,0,"tr",12)(27,re,1,1,"tr",13),a()()}if(t&2){let e=u(2);l(8),_("dataSource",e.ICDCodes),l(18),_("matHeaderRowDef",e.codeTableColumn),l(),_("matRowDefColumns",e.codeTableColumn)}}function de(t,i){if(t&1&&(n(0,"div",2)(1,"table",3),p(2,4),m(3,ft,2,0,"th",5)(4,xt,2,1,"td",6),s(),p(5,7),m(6,St,2,0,"th",5)(7,Dt,2,1,"td",6),s(),p(8,8),m(9,ht,2,0,"th",5)(10,vt,2,1,"td",6),s(),p(11,9),m(12,Pt,2,0,"th",5)(13,Tt,2,1,"td",6),s(),p(14,10),m(15,bt,2,0,"th",5)(16,wt,3,1,"td",6),s(),p(17,11),m(18,gt,2,0,"th",5)(19,Et,3,4,"td",6),s(),m(20,yt,1,0,"tr",12)(21,It,1,1,"tr",13),a()(),m(22,Vt,6,0),n(23,"div",14),m(24,Rt,4,0,"button",15),n(25,"form",16)(26,"div",17)(27,"div",18)(28,"mat-label",19),o(29,"Transcript"),a(),n(30,"mat-form-field",20),S(31,"textarea",21),a()(),n(32,"div",22)(33,"mat-label",19),o(34,"Optimized Transcript"),a(),n(35,"mat-form-field",20),S(36,"textarea",23),a()()(),n(37,"div",24)(38,"div",18)(39,"div",25)(40,"mat-label",19),o(41,"Summary"),a(),m(42,Nt,4,0,"button",15),a(),n(43,"mat-form-field",20),S(44,"textarea",26),a()()(),n(45,"div",27),m(46,kt,4,0,"button",28)(47,qt,28,3,"div",29)(48,me,28,3,"div",30),a()()()),t&2){let e=u();l(),_("dataSource",e.dataSource),l(19),_("matHeaderRowDef",e.tableColumn),l(),_("matRowDefColumns",e.tableColumn),l(),T(22,e.citations&&e.citations.length?22:-1),l(2),T(24,e.progressStatus==="0"?24:-1),l(),_("formGroup",e.patientDetailsForm),l(6),_("readonly",!0),l(5),_("readonly",!0),l(6),T(42,e.progressStatus==="1"||e.progressStatus==="2"?42:-1),l(2),_("readonly",!0),l(2),T(46,e.progressStatus==="3"?46:-1),l(),T(47,e.CPTCodes&&e.CPTCodes.length?47:-1),l(),T(48,e.ICDCodes&&e.ICDCodes.length?48:-1)}}function _e(t,i){t&1&&(n(0,"p",59),o(1,"No Data Available"),a())}var ye=(()=>{let i=class i{constructor(){this.patientService=b(Ct),this.activatedRoute=b(z),this.modalService=b(Y),this.changeDetector=b(F),this.tableColumn=["Patient Name","Patient Id","Patient Type","Prompt Type","Audio","Created Date"],this.codeTableColumn=["Sr no","Code","Description","Action","Review"],this.dataSource=[]}ngOnInit(){this.patientId=this.activatedRoute.snapshot.paramMap.get("id"),this.patientId&&(this.getPatientData(this.patientId),this.patientDetailsForm=new B({transcript:new w(""),optimizedTranscript:new w(""),summary:new w(""),chooseTranscript:new w("")}))}getPatientData(d,r){let c=sessionStorage.getItem("role"),f;c===st.doctor?f={}:f={created_by_id:sessionStorage.getItem("doctorId")?sessionStorage.getItem("doctorId"):""},this.patientService.retrievePatientHistory(f,d).pipe().subscribe({next:C=>{if(C){let I=C;I.status===200&&(this.dataSource=[I.data],this.progressStatus=C?.data?.progress_status,this.patientDetailsForm.get("transcript")?.setValue(C?.data?.transcript||"No Data Available"),this.patientDetailsForm.get("optimizedTranscript")?.setValue(JSON.parse(C?.data?.optimize_transcript)?.OptimizedTranscription||JSON.parse(C?.data?.optimize_transcript)?.optimizedTranscription||"No Data Available"),this.patientDetailsForm.get("summary")?.setValue(C?.data?.summary||"No Data Available"),this.ICDCodes=C?.data?.mcd_code.filter(g=>g?.type==="icd"),this.CPTCodes=C?.data?.mcd_code.filter(g=>g?.type==="cpt"),this.citations=JSON.parse(C?.data?.citation))}}})}sendCodeReview(d,r){let c=r.value;if(c&&d){let f={id:d,data:c,type:""};this.patientService.reviewPatient(f).pipe().subscribe({next:C=>{C&&C?.status===200&&this.getPatientData(this.patientId)}})}}sendCodeReviewType(d,r){let c=r.target.value;if(c&&d){let f={id:d,data:c,type:"review"};this.patientService.reviewPatient(f).pipe().subscribe({next:C=>{C&&C?.status===200&&this.getPatientData(this.patientId)}})}}generateTranscript(){let d={patient_id:this.dataSource[0].id,prompt_id:this.dataSource[0].prompt_id,transcript:this.dataSource[0].transcript,is_edited:!1};this.patientService.generateSummary(d).pipe().subscribe({next:r=>{r&&this.getPatientData(this.patientId)}})}generateCode(){let d={patient_id:this.dataSource[0].id};this.patientService.generateCode(d).pipe().subscribe({next:r=>{r&&this.getPatientData(this.patientId)}})}addNewCodes(d){this.modalService.open(ut,{maxWidth:"700px",data:{patentModel_id:this.patientId,patientId:this.dataSource[0].patient_id,codeType:d}}).afterClosed().subscribe(c=>{c&&this.getPatientData(this.patientId)})}};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=M({type:i,selectors:[["app-patient-details"]],standalone:!0,features:[$],decls:6,vars:1,consts:[[1,"patientDetailsWrapper","p-3"],[1,"container-fluid"],[1,"tableWrapper"],["mat-table","",3,"dataSource"],["matColumnDef","Patient Name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Patient Id"],["matColumnDef","Patient Type"],["matColumnDef","Prompt Type"],["matColumnDef","Audio"],["matColumnDef","Created Date"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"id",4,"matRowDef","matRowDefColumns"],[1,"otherDetailsWrapper","mt-4"],[1,"btn","submit-btn1","d-flex","align-items-center"],[3,"formGroup"],[1,"row"],[1,"col-12"],[1,"control-label"],["appearance","outline",1,"form-field"],["matInput","","formControlName","transcript","rows","10",3,"readonly"],[1,"col-12","my-3"],["matInput","","formControlName","optimizedTranscript","rows","10",3,"readonly"],[1,"row","my-3"],[1,"d-flex","align-items-center","justify-content-between","my-3"],["matInput","","formControlName","summary","rows","10",3,"readonly"],[1,"codesWrapper","my-3","py-3"],[1,"btn","submit-btn1","d-flex","align-items-center","mb-3"],[1,"tableWrapper","p-3","mb-3"],[1,"tableWrapper","p-3"],["mat-header-cell",""],["mat-cell",""],["controls",""],["type","audio/mp3",3,"src"],["mat-header-row",""],["mat-row","",3,"id"],[1,"control-label","my-3"],[1,"citationView"],[1,"btn","submit-btn1","d-flex","align-items-center",3,"click"],[1,"me-3"],[1,"btn","submit-btn1","d-flex","align-items-center","mb-3",3,"click"],[1,"d-flex","align-items-center","justify-content-between","mb-2"],[1,"btn","submit-btn1","d-flex","align-items-center","my-2",3,"click"],["mat-table","",1,"cptCodeTable",3,"dataSource"],["matColumnDef","Sr no"],["matColumnDef","Code"],["matColumnDef","Description"],["matColumnDef","Action"],["matColumnDef","Review"],["class","mat-row text-center","style","height: 60px;",4,"matNoDataRow"],["aria-label","Select an option","color","primary",3,"change","value"],["value","0"],["value","1"],["value","2"],[1,"form-field",3,"keydown.enter","value"],[1,"mat-row","text-center",2,"height","60px"],[1,"mat-cell"],["mat-table","",1,"icdCodeTable",3,"dataSource"],[1,"text-center"]],template:function(r,c){r&1&&(n(0,"div",0)(1,"div",1)(2,"h2"),o(3,"Patient Details"),a(),m(4,de,49,13)(5,_e,2,0),a()()),r&2&&(l(4),T(4,c.dataSource.length?4:5))},dependencies:[pt,J,H,G,j,L,U,Q,K,q,X,Z,et,ot,it,tt,lt,nt,at,rt,mt,dt,_t,ct,W],styles:[".patientDetailsWrapper[_ngcontent-%COMP%]{max-width:1800px;margin:0 auto}.patientDetailsWrapper[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{width:100%}.patientDetailsWrapper[_ngcontent-%COMP%]   .control-label[_ngcontent-%COMP%]{font-size:16px;font-weight:500;margin-bottom:8px;display:inline-block}.patientDetailsWrapper[_ngcontent-%COMP%]   .citationView[_ngcontent-%COMP%]{height:350px;overflow-y:auto;border:1px solid #ddd;padding:12px}"]});let t=i;return t})();export{ye as PatientDetailsComponent};
