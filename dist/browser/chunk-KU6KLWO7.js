import{a as M}from"./chunk-BQ62KYW7.js";import{a as it}from"./chunk-LURNVO4I.js";import{a as ot}from"./chunk-EQQULXW2.js";import{a as at}from"./chunk-WG7QQHNH.js";import{Q as et,a as O,b as y,c as R,d as G,e as j,g as x,h as H,i as U,j as B,ka as rt,n as W,o as $,p as z,s as J,t as K,v as Q,w as X,x as Y,y as Z,z as tt}from"./chunk-7RWZJSZU.js";import{h as L,j as N}from"./chunk-QNDYK3DZ.js";import{Ab as o,Bb as w,Fb as S,Kb as _,Mb as u,Ub as l,Va as p,Vb as k,Wa as I,Xb as A,ac as q,ca as s,ha as V,mb as c,ob as h,qa as P,ra as g,ub as d,vb as T,xb as E,yb as D,zb as a}from"./chunk-JETHE2PU.js";import{a as F,b}from"./chunk-DM275RSA.js";function nt(t,m){if(t&1&&(a(0,"mat-option",16),l(1),o()),t&2){let n=m.$implicit;h("value",n),p(),k(n==null?null:n.key)}}function mt(t,m){if(t&1&&E(0,nt,2,2,"mat-option",16,T),t&2){let n=u(2);D(n.promptList)}}function lt(t,m){if(t&1){let n=S();a(0,"div",6)(1,"mat-label",8),l(2,"Select prompt"),o(),a(3,"mat-form-field",9)(4,"mat-select",15),_("selectionChange",function(e){P(n);let i=u();return g(i.onSelectionChange(e))}),c(5,mt,2,0),o()()()}if(t&2){let n=u();p(5),d(5,n.promptList&&n.promptList.length?5:-1)}}function pt(t,m){t&1&&(a(0,"mat-error",11),l(1,"Prompt name is required"),o())}function st(t,m){t&1&&(a(0,"mat-error",11),l(1,"Prompt text is required"),o())}function ct(t,m){if(t&1&&(a(0,"mat-option",16),l(1),o()),t&2){let n=m.$implicit;h("value",n.id),p(),k(n.title)}}function dt(t,m){if(t&1&&E(0,ct,2,2,"mat-option",16,T),t&2){let n=u();D(n.promptTemplate)}}function ut(t,m){t&1&&(a(0,"mat-error",11),l(1,"Template type is required"),o())}function ft(t,m){if(t&1){let n=S();a(0,"button",17),_("click",function(){P(n);let e=u();return g(e.updatePrompt(e.promptData.promptdata.id))}),l(1,"Update"),o()}}function ht(t,m){if(t&1){let n=S();a(0,"button",17),_("click",function(){P(n);let e=u();return g(e.createPrompt())}),l(1,"Save"),o()}}var Lt=(()=>{let m=class m{constructor(r){this.data=r,this.apiService=s(M),this.router=s(N),this.activatedRoute=s(L),this.toasterService=s(ot),this.modalService=s(Z),this.patientService=s(at),this.dialogRef=s(X,{optional:!0}),this.doctorService=s(M),this.promptList=[],this.pagination={search_key:"",search_column:"",order:"desc",page:1},this.showPrompt=!1,this.data&&(this.promptData=this.data)}ngOnInit(){this.initForm(),sessionStorage.getItem("role")===it.organisation?(this.showPrompt=!0,this.loadPromptHIstoryForOrg(this.pagination)):this.loadPromptHIstory(this.pagination),this.retrievePromptType(),this.promptData?.isEdit&&this.patchValue()}retrievePromptType(){this.apiService.retrievePromptType().pipe().subscribe({next:r=>{r.data.length&&(this.promptTemplate=r.data)}})}patchValue(){console.log(this.promptData),this.createPromptForm.get("key")?.setValue(this.promptData.promptdata.promptName),this.createPromptForm.get("value")?.setValue(this.promptData.promptdata.text),this.createPromptForm.get("type")?.setValue(+this.promptData.promptdata.typeId)}initForm(){this.createPromptForm=new j({key:new x("",[y.required]),value:new x("",[y.required]),type:new x("",[y.required])})}createPrompt(){if(this.createPromptForm.valid){let r=b(F({},this.createPromptForm.value),{type:this.createPromptForm.get("type").value});this.apiService.createPrompt(r).subscribe({next:e=>{e&&e.status===200&&(this.toasterService.success("Prompt Added Successfully"),this.closeModel(!0))},error:e=>{this.toasterService.error(e?.error?.message)}})}else this.createPromptForm.markAllAsTouched(),this.createPromptForm.markAsDirty()}updatePrompt(r){if(this.createPromptForm.valid){let e=b(F({},this.createPromptForm.value),{prompt_id:r});this.apiService.updatePrompt(r,e).subscribe({next:i=>{i&&i.status===200&&(this.toasterService.success("Prompt Updated Successfully"),this.closeModel(!0))},error:i=>{this.toasterService.error(i?.error?.message)}})}else this.createPromptForm.markAllAsTouched(),this.createPromptForm.markAsDirty()}closeModel(r){this.dialogRef?.close(r)}loadPromptHIstory(r){this.doctorService.retrievePromptList(r).subscribe({next:e=>{e&&(this.promptList=e?.data)}})}loadPromptHIstoryForOrg(r){this.doctorService.retrievePromptforOrg(r).subscribe({next:e=>{e&&(this.promptList=e?.data)}})}onSelectionChange(r){let e=r.value;this.createPromptForm.get("value")?.setValue(e?.value),this.createPromptForm.get("type")?.setValue(+e?.type),this.createPromptForm.get("type")?.disable()}};m.\u0275fac=function(e){return new(e||m)(I(Y,8))},m.\u0275cmp=V({type:m,selectors:[["app-create-prompt"]],standalone:!0,features:[q],decls:33,vars:10,consts:[[1,"createPromptWrapper"],[1,"d-flex","align-items-center","justify-content-between"],[1,"btn",3,"click","mat-dialog-close"],[1,"container-fluid"],[1,"promptForm",3,"formGroup"],[1,"row"],[1,"col-12","my-3"],[1,"form-group"],[1,"control-label"],["appearance","outline",1,"form-field"],["matInput","","placeholder","Prompt name","formControlName","key","autocomplete","off"],[1,"error-msg","mt-2"],["matInput","","placeholder","Prompt text","formControlName","value","autocomplete","off","rows","4"],["formControlName","type","placeholder","Select your template type"],[1,"btn","submit-btn","w-100"],["placeholder","Select your prompt",3,"selectionChange"],[3,"value"],[1,"btn","submit-btn","w-100",3,"click"]],template:function(e,i){if(e&1&&(a(0,"div",0)(1,"h2",1),l(2),a(3,"button",2),_("click",function(){return i.closeModel(!1)}),a(4,"mat-icon"),l(5,"close"),o()()(),a(6,"div",3)(7,"form",4)(8,"div",5),c(9,lt,6,1,"div",6),a(10,"div",6)(11,"div",7)(12,"mat-label",8),l(13,"Template name"),o(),a(14,"mat-form-field",9),w(15,"input",10),o()(),c(16,pt,2,0,"mat-error",11),o(),a(17,"div",6)(18,"div",7)(19,"mat-label",8),l(20,"Prompt text"),o(),a(21,"mat-form-field",9),w(22,"textarea",12),o()(),c(23,st,2,0,"mat-error",11),o(),a(24,"div",6)(25,"mat-label",8),l(26,"Template type"),o(),a(27,"mat-form-field",9)(28,"mat-select",13),c(29,dt,2,0),o()(),c(30,ut,2,0,"mat-error",11),o()(),c(31,ft,2,0,"button",14)(32,ht,2,0),o()()()),e&2){let f,C,v;p(2),A("",i.promptData.isEdit?"Update":"Create"," Prompt ",i.promptData.isEdit?"Details":""," "),p(),h("mat-dialog-close",!0),p(4),h("formGroup",i.createPromptForm),p(2),d(9,i.showPrompt?9:-1),p(7),d(16,(f=i.createPromptForm.get("key"))!=null&&f.hasError("required")&&((f=i.createPromptForm.get("key"))!=null&&f.touched)?16:-1),p(7),d(23,(C=i.createPromptForm.get("value"))!=null&&C.hasError("required")&&((C=i.createPromptForm.get("value"))!=null&&C.touched)?23:-1),p(6),d(29,i.promptTemplate&&i.promptTemplate.length?29:-1),p(),d(30,(v=i.createPromptForm.get("type"))!=null&&v.hasError("required")&&((v=i.createPromptForm.get("type"))!=null&&v.touched)?30:-1),p(),d(31,i.promptData&&i.promptData.isEdit?31:32)}},dependencies:[rt,H,O,R,G,U,B,K,J,$,z,Q,tt,et,W],styles:[".createPromptWrapper[_ngcontent-%COMP%]{padding:24px}"]});let t=m;return t})();export{Lt as a};
