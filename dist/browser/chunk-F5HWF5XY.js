import{d as At,e as Nt,f as Wt}from"./chunk-CDS4ARN5.js";import{a as Ut}from"./chunk-GGWBAYTK.js";import{a as Lt}from"./chunk-EQQULXW2.js";import{a as zt}from"./chunk-WG7QQHNH.js";import{A as _t,B as gt,C as Ct,D as ft,F as vt,G as xt,H as bt,I as St,J as Dt,K as yt,L as Tt,M as Et,N as Pt,O as wt,Q as Mt,R as Ft,U as Ot,V as Rt,X as Vt,Y as kt,a as Z,b as w,c as tt,d as et,e as it,g as D,h as nt,i as at,j as rt,ka as It,n as ot,o as lt,p as st,s as dt,t as mt,u as ct,v as pt,y as ut,z as ht}from"./chunk-7RWZJSZU.js";import"./chunk-RGNDWIHZ.js";import"./chunk-QNDYK3DZ.js";import{k as K}from"./chunk-WLRUUNHX.js";import{Ab as o,Bb as f,Cb as x,Db as b,Fb as S,Kb as v,Mb as h,Qb as L,Ra as $,Rb as z,Sa as M,Sb as U,Ub as s,Va as d,Vb as P,Wb as E,ab as j,ac as J,ca as T,gc as X,ha as B,mb as u,nb as Q,ob as c,oc as Y,qa as g,ra as C,ub as _,vb as A,xb as N,yb as W,zb as r}from"./chunk-JETHE2PU.js";import{a as G,b as q,g as H}from"./chunk-DM275RSA.js";var $t=["citationsModal"],Gt=["uploadControl"],qt=["summaryControl"];function Ht(t,l){t&1&&(r(0,"mat-error",13),s(1,"Please enter patient name"),o())}function Bt(t,l){t&1&&(r(0,"mat-error",13),s(1,"Numeric values not allowed."),o())}function jt(t,l){t&1&&(r(0,"mat-error",13),s(1,"Special characters not allowed."),o())}function Qt(t,l){t&1&&(r(0,"mat-error",13),s(1,"Please enter patient ID"),o())}function Jt(t,l){t&1&&(r(0,"mat-error",13),s(1,"Maximum 100 characters allowed!"),o())}function Xt(t,l){t&1&&(r(0,"mat-error",13),s(1,"Special characters not allowed"),o())}function Yt(t,l){t&1&&(r(0,"mat-error",13),s(1,"Space not allowed"),o())}function Kt(t,l){if(t&1&&(r(0,"mat-radio-button",22),s(1),o()),t&2){let a=l.$implicit;c("value",a.value),d(),P(a.label)}}function Zt(t,l){if(t&1&&(r(0,"audio",54),f(1,"source",57),o()),t&2){let a=h(2);d(),c("src",a.uploadedFileUrl,M)}}function te(t,l){if(t&1){let a=S();r(0,"div",24)(1,"mat-label",10),s(2,"Upload Audio File"),o(),r(3,"div",52)(4,"input",53,1),v("change",function(i){g(a);let n=h();return C(n.onFileSelected(i))}),o(),u(6,Zt,2,1,"audio",54),r(7,"button",55),v("click",function(){g(a);let i=h();return C(i.deleteUploadedFile())}),f(8,"img",56),o()()()}if(t&2){let a=h();d(4),Q("disabled",a.isGenerateTranscript),d(2),_(6,a.uploadedFileUrl?6:-1),d(),c("ngClass",a.isDelete?"d-none":"d-block")}}function ee(t,l){if(t&1&&(r(0,"p"),s(1),o()),t&2){let a=h(2);d(),P(a.formatTime(a.elapsedTime))}}function ie(t,l){if(t&1&&(r(0,"div",59)(1,"audio",54),f(2,"source",57),o()()),t&2){let a=h(2);d(2),c("src",a.audioURL,M)}}function ne(t,l){if(t&1){let a=S();r(0,"div",58),u(1,ee,2,1,"p")(2,ie,3,1,"div",59),r(3,"div",60)(4,"button",61),v("click",function(){g(a);let i=h();return C(i.isRecording?i.stopRecording():i.startRecording())}),f(5,"img",62),o(),r(6,"button",63),v("click",function(){g(a);let i=h();return C(i.isPaused?i.resumeRecording():i.pauseRecording())}),f(7,"img",64),o(),r(8,"button",65),v("click",function(){g(a);let i=h();return C(i.deleteRecording())}),f(9,"img",66),o()()()}if(t&2){let a=h();d(),_(1,a.isRecording||a.isPaused?1:-1),d(),_(2,a.audioURL?2:-1),d(2),c("ngClass",a.isRecording&&!a.isPaused?"animate":"")("disabled",a.isStop)("matTooltip",a.isRecording?"Stop":"Record"),d(),c("src",a.isRecording?"../../../assets/stopRecording.svg":"../../../assets/microphone.svg",M),d(),c("disabled",!a.isRecording)("matTooltip",a.isPaused?"Resume":"Pause"),d(),c("src",a.isPaused?"../../../assets/playRecording.svg":"../../../assets/pauseRecording.svg",M),d(),c("disabled",a.audioURL?null:!0)("ngClass",a.isDelete?"d-none":"d-block")}}function ae(t,l){t&1&&(r(0,"mat-error",13),s(1,"Audio file is required"),o())}function re(t,l){if(t&1){let a=S();r(0,"a",67),v("click",function(){g(a);let i=h();return C(i.showCitations())}),s(1,"View Citations"),o()}}function oe(t,l){t&1&&f(0,"div",40)}function le(t,l){if(t&1&&(r(0,"mat-option",22),s(1),o()),t&2){let a=l.$implicit;c("value",a.id),d(),P(a.key)}}function se(t,l){if(t&1&&N(0,le,2,2,"mat-option",22,A),t&2){let a=h();W(a.promptTemplate)}}function de(t,l){t&1&&(r(0,"mat-error",13),s(1,"Prompt is required"),o())}function me(t,l){t&1&&(r(0,"th",82),s(1," Sr no "),o())}function ce(t,l){if(t&1&&(r(0,"td",83),s(1),o()),t&2){let a=l.index;d(),E(" ",a+1," ")}}function pe(t,l){t&1&&(r(0,"th",84),s(1," Code "),o())}function ue(t,l){if(t&1&&(r(0,"td",83),s(1),o()),t&2){let a=l.$implicit;d(),E(" ",a.code," ")}}function he(t,l){t&1&&(r(0,"th",85),s(1," Citation "),o())}function _e(t,l){if(t&1&&(r(0,"td",83),s(1),o()),t&2){let a=l.$implicit;d(),E(" ",a.description," ")}}function ge(t,l){t&1&&(r(0,"th",82),s(1,"Action"),o())}function Ce(t,l){if(t&1){let a=S();r(0,"td",83)(1,"mat-radio-group",86),v("change",function(i){let n=g(a).$implicit,m=h(2);return C(m.sendCodeReview(n.id,i))}),r(2,"mat-radio-button",19),s(3,"Ok"),o(),r(4,"mat-radio-button",20),s(5,"Not Ok"),o(),r(6,"mat-radio-button",20),s(7,"Not Sure"),o()()()}if(t&2){let a=l.$implicit;d(),c("value",a.status?a.status:null)}}function fe(t,l){t&1&&(r(0,"th",82),s(1,"Review"),o())}function ve(t,l){if(t&1){let a=S();r(0,"td",83)(1,"textarea",87),v("keydown.enter",function(i){let n=g(a).$implicit,m=h(2);return C(m.sendCodeReviewType(n.id,i))}),o()()}if(t&2){let a=l.$implicit;d(),c("value",a.reviewer?a.reviewer:null)}}function xe(t,l){t&1&&f(0,"tr",88)}function be(t,l){if(t&1&&f(0,"tr",89),t&2){let a=l.$implicit;c("id",a.id)}}function Se(t,l){if(t&1){let a=S();r(0,"div",51)(1,"div",68)(2,"h5"),s(3,"CPT Codes"),o(),r(4,"button",69),v("click",function(){g(a);let i=h();return C(i.addNewCodes("cpt"))}),r(5,"mat-icon"),s(6,"add"),o(),s(7," Add CPT Codes"),o()(),r(8,"table",70),x(9,71),u(10,me,2,0,"th",72)(11,ce,2,1,"td",73),b(),x(12,74),u(13,pe,2,0,"th",75)(14,ue,2,1,"td",73),b(),x(15,76),u(16,he,2,0,"th",77)(17,_e,2,1,"td",73),b(),x(18,78),u(19,ge,2,0,"th",72)(20,Ce,8,1,"td",73),b(),x(21,79),u(22,fe,2,0,"th",72)(23,ve,2,1,"td",73),b(),u(24,xe,1,0,"tr",80)(25,be,1,1,"tr",81),o()()}if(t&2){let a=h();d(8),c("dataSource",a.CPTCodes),d(16),c("matHeaderRowDef",a.tableColumn),d(),c("matRowDefColumns",a.tableColumn)}}function De(t,l){t&1&&(r(0,"th",82),s(1," Sr no "),o())}function ye(t,l){if(t&1&&(r(0,"td",83),s(1),o()),t&2){let a=l.index;d(),E(" ",a+1," ")}}function Te(t,l){t&1&&(r(0,"th",84),s(1," Code "),o())}function Ee(t,l){if(t&1&&(r(0,"td",83),s(1),o()),t&2){let a=l.$implicit;d(),E(" ",a.code," ")}}function Pe(t,l){t&1&&(r(0,"th",85),s(1," Citation "),o())}function we(t,l){if(t&1&&(r(0,"td",83),s(1),o()),t&2){let a=l.$implicit;d(),E(" ",a.description," ")}}function Me(t,l){t&1&&(r(0,"th",82),s(1,"Action"),o())}function Fe(t,l){if(t&1){let a=S();r(0,"td",83)(1,"mat-radio-group",86),v("change",function(i){let n=g(a).$implicit,m=h(2);return C(m.sendCodeReview(n.id,i))}),r(2,"mat-radio-button",19),s(3,"Ok"),o(),r(4,"mat-radio-button",20),s(5,"Not Ok"),o(),r(6,"mat-radio-button",20),s(7,"Not Sure"),o()()()}if(t&2){let a=l.$implicit;d(),c("value",a.status?a.status:null)}}function Oe(t,l){t&1&&(r(0,"th",82),s(1,"Review"),o())}function Re(t,l){if(t&1){let a=S();r(0,"td",83)(1,"textarea",87),v("keydown.enter",function(i){let n=g(a).$implicit,m=h(2);return C(m.sendCodeReviewType(n.id,i))}),o()()}if(t&2){let a=l.$implicit;d(),c("value",a.reviewer?a.reviewer:null)}}function Ve(t,l){t&1&&f(0,"tr",88)}function ke(t,l){if(t&1&&f(0,"tr",89),t&2){let a=l.$implicit;c("id",a.id)}}function Ie(t,l){if(t&1){let a=S();r(0,"div",51)(1,"div",68)(2,"h5"),s(3,"ICD Codes"),o(),r(4,"button",69),v("click",function(){g(a);let i=h();return C(i.addNewCodes("icd"))}),r(5,"mat-icon"),s(6,"add"),o(),s(7," Add ICD Codes"),o()(),r(8,"table",70),x(9,71),u(10,De,2,0,"th",72)(11,ye,2,1,"td",73),b(),x(12,74),u(13,Te,2,0,"th",75)(14,Ee,2,1,"td",73),b(),x(15,76),u(16,Pe,2,0,"th",77)(17,we,2,1,"td",73),b(),x(18,78),u(19,Me,2,0,"th",72)(20,Fe,8,1,"td",73),b(),x(21,79),u(22,Oe,2,0,"th",72)(23,Re,2,1,"td",73),b(),u(24,Ve,1,0,"tr",80)(25,ke,1,1,"tr",81),o()()}if(t&2){let a=h();d(8),c("dataSource",a.ICDCodes),d(16),c("matHeaderRowDef",a.tableColumn),d(),c("matRowDefColumns",a.tableColumn)}}function Ae(t,l){if(t&1&&(r(0,"li")(1,"p"),s(2),o(),r(3,"p"),s(4),o()()),t&2){let a=l.$implicit;d(2),P(a.start),d(2),P(a.text)}}function Ne(t,l){if(t&1&&(r(0,"ul"),N(1,Ae,5,2,"li",null,A),o()),t&2){let a=h(2);d(),W(a.citation)}}function We(t,l){if(t&1&&(r(0,"h2",90),s(1,"Citations"),o(),r(2,"mat-dialog-content"),u(3,Ne,3,0,"ul"),o(),r(4,"mat-dialog-actions",91)(5,"button",92),s(6,"Close"),o()()),t&2){let a=h();d(3),_(3,a.citation.length?3:-1)}}var mi=(()=>{let l=class l{constructor(){this.commonService=T(ft),this.changeDet=T(Y),this.patientService=T(zt),this.toasterService=T(Lt),this.modalService=T(ut),this.render2=T(j),this.isRecording=!1,this.isPaused=!1,this.isStop=!1,this.isAudioRecorded=!1,this.isUploadFile=!1,this.isGenerate=!0,this.isGenerateSummary=!0,this.isEditable=!0,this.isTranscriptDisable=!0,this.isGenerateTranscript=!1,this.isDelete=!1,this.isLoading=!1,this.audioChunks=[],this.audioURL="",this.newText="",this.transcriptValue="",this.isContentEditable=!1,this.optimizedTranscriptValue="",this.typingSpeed=10,this.loop=!0,this.currentIndex=0,this.currentText="",this.isDeleting=!1,this.CPTCodes=[],this.ICDCodes=[],this.tableColumn=["Sr no","Code","Description","Action","Review"],this.transcriptArray=[],this.pagination={search_key:"",search_column:"",page:1,per_page:10},this.elapsedTime=0,this.fileOptions=[{value:"1",label:"Record Audio"},{value:"2",label:"Upload File"}],this.accessibleFeature={}}ngOnInit(){this.initForm(),this.retrievePromptList(),this.generateCodes(),this.getFeatureList()}initForm(){this.patientDetailsForm=new it({patientName:new D("",[w.required,At,Wt]),patientId:new D("",[w.required,Nt,w.maxLength(100)]),audioFile:new D,audioOption:new D("1"),patientType:new D("1",[w.required]),promptId:new D(1,[w.required]),optimizedtranscript:new D(""),summary:new D(""),validChoice:new D(""),chooseTranscript:new D("")})}getFeatureList(){let e=sessionStorage.getItem("doctorId");e&&this.patientService.getFeaturesList(e).pipe().subscribe({next:i=>{i&&(this.accessibleFeature=i?.data)}})}retrievePromptList(){let e=q(G({},this.pagination),{type:1});this.patientService.getPromptData(e).pipe().subscribe({next:i=>{i.data.length&&(this.promptTemplate=i.data)}})}enableOptions(e){this.uplodedFile=null,this.audioURL="",this.isRecording=!1,this.isStop=!1,this.patientDetailsForm.get("audioFile")?.setValue(""),e.value==="2"?this.isUploadFile=!0:this.isUploadFile=!1}onFileSelected(e){let i=e.target.files[0];this.isGenerate=!1;let n=25*1024*1024,m=new FileReader;i.size>n?(this.toasterService.error("File size exceeds 25 MB"),this.deleteUploadedFile()):(this.uplodedFile=i,m.readAsDataURL(i),m.onload=p=>{this.uploadedFileUrl=p.target?.result},this.patientDetailsForm.get("audioFile")?.setValue(this.uplodedFile))}startRecording(){return H(this,null,function*(){try{let e=yield navigator.mediaDevices.getUserMedia({audio:!0});this.stream=e,this.mediaRecorder=new MediaRecorder(e),this.isRecording=!0,this.isAudioRecorded=!1,this.audioChunks=[],this.elapsedTime=0,this.mediaRecorder.ondataavailable=i=>{i.data.size>0&&this.audioChunks.push(i.data)},this.mediaRecorder.onstop=()=>{let i=new Blob(this.audioChunks,{type:"audio/mpeg"});this.audioURL=URL.createObjectURL(i),this.isAudioRecorded=!0,this.isGenerate=!1,this.changeDet.detectChanges(),this.convertAudioToMp3(i),clearInterval(this.timer)},this.mediaRecorder.start(),this.startTimer()}catch(e){console.error("Error starting recording:",e)}})}stopRecording(){this.isRecording&&(this.isRecording=!1,this.mediaRecorder.stop(),this.stream.getTracks().forEach(e=>e.stop()),this.isStop=!0,this.isPaused=!1,this.changeDet.detectChanges(),clearInterval(this.timer))}pauseRecording(){this.isRecording&&this.mediaRecorder.state==="recording"&&(this.mediaRecorder.pause(),this.stream.getTracks().forEach(e=>e.enabled=!1),this.isPaused=!0,this.changeDet.detectChanges(),clearInterval(this.timer))}resumeRecording(){this.isRecording&&this.mediaRecorder.state==="paused"&&(this.stream.getTracks().forEach(e=>e.enabled=!0),this.mediaRecorder.resume(),this.isPaused=!1,this.changeDet.detectChanges(),this.startTimer())}startTimer(){this.timer=setInterval(()=>{this.elapsedTime++,this.changeDet.detectChanges()},1e3)}formatTime(e){let i=Math.floor(e/60),n=e%60;return`${this.pad(i)}:${this.pad(n)}`}pad(e){return e<10?"0"+e:e.toString()}convertAudioToMp3(e){let i=new File([e],"recording.mp3",{type:"audio/webm"});this.patientDetailsForm.get("audioFile")?.setValue(e),this.changeDet.detectChanges()}submitPatientDetails(){if(this.audioURL||this.uplodedFile)if(this.patientDetailsForm.valid){this.isDelete=!0,this.fileOptions.length>1&&(this.audioURL?this.fileOptions.splice(1,1):this.uplodedFile&&this.fileOptions.splice(0,1)),this.transcriptArray=[],this.patientDetailsForm.get("transcript")?.reset();let e={patientName:this.patientDetailsForm.get("patientName")?.value,patientId:this.patientDetailsForm.get("patientId")?.value,audioFile:this.patientDetailsForm.get("audioFile")?.value||this.uplodedFile,type_id:this.patientDetailsForm.get("patientType")?.value,promptId:this.patientDetailsForm.get("promptId")?.value};this.commonService.loaderMessage.set("Loading..."),this.isGenerateTranscript=!0,this.patientService.createPatient(e).subscribe({next:i=>{if(i){let n=i;n.status===200?(this.currentIndex=0,this.patientDetailsForm.get("transcript")?.setValue(""),this.transcriptArray=n.data.transcript.split(" "),this.patientId=n.data.id,this.citation=JSON.parse(n?.data?.citation),this.typingAnimation(),this.optimizeTranscript(this.patientId)):this.toasterService.error("Error: "+(n.message||"An unexpected error occurred"))}},error:i=>{this.toasterService.success(i?.error?.message)},complete:()=>{this.commonService.loaderMessage.set("")}})}else this.patientDetailsForm.markAllAsTouched(),this.patientDetailsForm.markAsDirty(),this.toasterService.error("Please fill out the form correctly before submitting.");else this.toasterService.error("Audio File is Required")}generateSummary(){this.commonService.loaderMessage.set("Generating Summary");let e=document.querySelector(".original-transcript").textContent;if(this.patientDetailsForm.valid&&e){let i={patient_id:this.patientId?this.patientId:0,transcript:e,is_edited:this.isEditable,prompt_id:this.patientDetailsForm.get("promptId")?.value,selected_transcript_type:this.patientDetailsForm.get("chooseTranscript")?.value};this.patientService.generateSummary(i).subscribe({next:n=>{n&&this.patientDetailsForm.get("summary")?.setValue(n?.data?.summary)},error:n=>{this.toasterService.success(n?.error?.message),this.commonService.loaderMessage.set("")},complete:()=>{this.isGenerateSummary=!0,this.commonService.loaderMessage.set(""),this.generateCodes()}})}else this.toasterService.error("Transcript is empty ")}typingAnimation(){if(this.isGenerate=!0,this.transcriptArray.length){let e=this.currentIndex%this.transcriptArray.length,i=this.transcriptArray[e];if(this.currentIndex>=this.transcriptArray.length){this.isEditable=!1,this.isTranscriptDisable=!1,this.transcriptArray=[],this.currentText="";return}this.currentIndex++,this.currentText+=i+" ",this.transcriptValue=this.currentText,this.isContentEditable=!0,setTimeout(()=>{this.typingAnimation()},this.typingSpeed)}}deleteRecording(){this.audioURL=null,this.audioChunks=[],this.isStop=!1,this.isPaused=!1,this.patientDetailsForm.get("audioFile")?.setValue(""),this.changeDet.detectChanges()}deleteUploadedFile(){this.uploadedFileUrl=null}optimizeTranscript(e){this.isLoading=!0;let i={patient_id:e};this.patientService.optimiseTranscript(i).subscribe({next:n=>{if(n){this.isLoading=!1;try{let m=JSON.parse(n?.data?.optimize_transcript);if(m){console.log(m);try{let p=m["JSONText:"]||m?.JSONText;this.factualError=p?.factual,this.factualErrorStates=new Array(this.factualError.length).fill(!1),this.grammaticalError=p?.grammatical,this.grammaticalErrorStates=new Array(this.grammaticalError.length).fill(!1),this.medTermError=p?.medTerm,this.medTermErrorStates=new Array(this.medTermError.length).fill(!1),this.optimizedTranscriptValue=this.highlightErrors()}catch{this.optimizedTranscriptValue=this.transcriptValue}}else this.optimizedTranscriptValue=this.transcriptValue}catch{this.optimizedTranscriptValue=this.transcriptValue}}},error:n=>{this.toasterService.success(n?.error?.message),this.commonService.loaderMessage.set(""),this.isLoading=!1,this.optimizedTranscriptValue=this.transcriptValue}})}get transcriptChoice(){return this.patientDetailsForm.get("chooseTranscript")?.value}copyToClipBoard(e){let i;e==="transcript"?i=document.querySelector(".original-transcript").textContent:i=this.patientDetailsForm.get(e)?.value,i?navigator.clipboard.writeText(i).then(()=>{this.toasterService.success("Copied")}).catch(n=>{this.toasterService.error("Failed to Copy")}):this.toasterService.error("No Value to copy")}selectTranscript(e){if(e.value==="1"){let i=document.querySelector(".original-transcript")?.textContent;i&&(this.userSelectedTranscript=i)}else{let i=document.querySelector(".optimized-transcript")?.textContent;i&&(this.userSelectedTranscript=i)}this.isGenerateSummary=!1}copySummary(){let e=this.summaryControl.nativeElement.innerText;e?navigator.clipboard.writeText(e).then(()=>{this.toasterService.success("Copied")}).catch(i=>{this.toasterService.error("Failed to Copy")}):this.toasterService.error("No Value to copy")}showCitations(){this.modalService.open(this.citationsModal,{width:"600px"})}generateCodes(){if(this.patientId){let e={patient_id:this.patientId};this.patientService.generateCode(e).subscribe({next:i=>{if(i){let n=i;n.status===200&&(this.ICDCodes=n.data.mcd_code.filter(m=>m.type==="icd"),this.CPTCodes=n.data.mcd_code.filter(m=>m.type==="cpt"))}},error:i=>{this.toasterService.success(i?.error?.message),this.commonService.loaderMessage.set("")}})}}sendCodeReview(e,i){let n=i.value;if(n&&e){let m={id:e,data:n,type:""};this.patientService.reviewPatient(m).pipe().subscribe({next:p=>{p&&p?.status}})}}sendCodeReviewType(e,i){let n=i.target.value;if(n&&e){let m={id:e,data:n,type:"review"};this.patientService.reviewPatient(m).pipe().subscribe({next:p=>{p&&p?.status}})}}addNewCodes(e){let i=this.modalService.open(Ut,{maxWidth:"700px",data:{patientId:this.patientId,codeType:e}})}toggleCorrection(e,i){switch(i){case"factualError":this.factualErrorStates[e]=!this.factualErrorStates[e],this.factualErrorStates[e]?this.applyCorrection(this.factualError[e].error,this.factualError[e].correction):this.undoChange(this.factualError[e].correction,this.factualError[e].error);break;case"grammaticalError":this.grammaticalErrorStates[e]=!this.grammaticalErrorStates[e],this.grammaticalErrorStates[e]?this.applyCorrection(this.grammaticalError[e].error,this.grammaticalError[e].correction):this.undoChange(this.grammaticalError[e].correction,this.grammaticalError[e].error);break;case"medTermError":this.medTermErrorStates[e]=!this.medTermErrorStates[e],this.medTermErrorStates[e]?this.applyCorrection(this.medTermError[e].error,this.medTermError[e].correction):this.undoChange(this.medTermError[e].correction,this.medTermError[e].error);break}}applyCorrection(e,i){this.transcriptValue=this.transcriptValue.replace(`<span class="error-highlight">${e}</span>`,`<span class="fix-highlight">${i}</span>`)}undoChange(e,i){this.transcriptValue=this.transcriptValue.replace(`<span class="fix-highlight">${e}</span>`,`<span class="error-highlight">${i}</span>`)}highlightErrors(){let e=this.transcriptValue;return[...this.factualError,...this.grammaticalError,...this.medTermError].forEach((i,n)=>{e=e.replace(i.error,`<span class="error-highlight error-at-${n}">${i.correction} </span>`)}),setTimeout(()=>{[...this.factualError,...this.grammaticalError,...this.medTermError].forEach((i,n)=>{let m=document.querySelector(`.error-highlight.error-at-${n}`);m&&(m.addEventListener("mouseover",p=>this.showTooltip(p,i)),m.addEventListener("mouseout",this.hideTooltip))})},2e3),e}showTooltip(e,i){let n=document.createElement("div");n.classList.add("hover-box"),n.innerHTML=`<span class="error">${i.error}</span> <span class="correction">${i.correction}</span>`,document.body.appendChild(n);let{clientX:m,clientY:p}=e;n.style.top=`${p+5}px`,n.style.left=`${m+5}px`,e.target.tooltip=n}hideTooltip(e){e.target.tooltip&&(document.body.removeChild(e.target.tooltip),e.target.tooltip=null)}};l.\u0275fac=function(i){return new(i||l)},l.\u0275cmp=B({type:l,selectors:[["app-patient-details"]],viewQuery:function(i,n){if(i&1&&(L($t,7),L(Gt,5),L(qt,5)),i&2){let m;z(m=U())&&(n.citationsModal=m.first),z(m=U())&&(n.uploadControl=m.first),z(m=U())&&(n.summaryControl=m.first)}},standalone:!0,features:[J],decls:110,vars:22,consts:[["citationsModal",""],["uploadControl",""],[1,"patientsDetailsWrapper"],[1,"container"],[1,"patientForm"],[3,"formGroup"],[1,"patientCard"],[1,"row"],[1,"col-12","col-sm-12","col-md-3","col-lg-3","col-xl-3","my-3"],[1,"form-group"],[1,"control-label"],["appearance","outline",1,"form-field"],["matInput","","placeholder","Enter patient name","formControlName","patientName"],[1,"error-msg"],["matInput","","placeholder","Enter Patient Id","formControlName","patientId"],[1,"col-12","col-sm-12","col-md-3","col-lg-3","col-xl-3","d-flex","align-items-center","my-3"],[1,"audioControl"],[1,"record-label","ps-3"],["aria-label","Select an option","color","primary","formControlName","patientType"],["value","1"],["value","2"],["aria-label","Select an option","color","primary","formControlName","audioOption",3,"change"],[3,"value"],[1,"col-12"],[1,"uploadFileControl","my-3"],[1,"col-12","my-3"],["type","button",1,"rounded-btn","btn","d-flex","align-items-center",3,"click","disabled"],[1,"me-3"],[1,"col-12","col-sm-12","col-md-6","col-lg-6"],[1,"transcriptWrapper"],[1,"col-6"],[1,"col-6","d-flex","align-items-center","justify-content-end"],["type","button",1,"btn"],["matTooltip","copy",1,"btn","copy-btn","p-0","mb-1",3,"click"],["src","../../../../assets/copy.svg","alt","copy"],[1,"original-transcript",3,"innerHTML","contentEditable"],[1,"optimizedtranscriptWrapper","h-100"],[1,"control-label","d-flex","align-items-center"],[1,"loaderWrapper"],[1,"optimized-transcript","suggestionBox",3,"innerHTML","contentEditable"],[1,"loader"],[1,"row","my-3"],[1,"col-12","col-sm-12","col-md-4","col-lg-4","d-flex","align-items-start","flex-column","justify-content-center"],["aria-label","Select an option","color","primary","formControlName","chooseTranscript",3,"change"],[1,"col-12","col-sm-12","col-md-4","col-lg-4"],["formControlName","promptId","placeholder","Select your template"],[1,"col-12","col-sm-12","col-md-4","col-lg-4","d-flex","justify-content-end","align-items-end"],[1,"rounded-btn","btn","m-0","d-flex","align-items-center",3,"click","disabled"],[1,"summeryWrapper"],["matTooltip","copy",1,"btn","copy-btn",3,"click"],["matInput","","placeholder","","rows","10","formControlName","summary","readonly",""],[1,"tableWrapper","my-3","p-3"],[1,"d-flex","justify-content-between","align-items-center"],["type","file","formControlName","audioFile",1,"uploadFileControl",3,"change"],["controls",""],[1,"btn",3,"click","ngClass"],["src","../../../assets/delete.svg","alt","deleteBtn","width","25","height","25",1,"img-fluid"],[3,"src"],[1,"recordAudioWrapper","my-3"],[1,"audioPlay"],[1,"record-control"],[1,"microphone-btn","btn",3,"click","ngClass","disabled","matTooltip"],["alt","play",1,"img-fluid",3,"src"],[1,"microphone-btn","btn",3,"click","disabled","matTooltip"],["alt","pause",1,"img-fluid",3,"src"],["matTooltip","Delete",1,"delete-btn","btn",3,"click","disabled","ngClass"],["src","../../../assets/delete.svg","alt","delete",1,"img-fluid"],["type","button",1,"btn",3,"click"],[1,"d-flex","align-items-center","justify-content-between","mb-2"],[1,"btn","rounded-btn","d-flex","align-items-center","my-2",3,"click"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","Sr no"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Code"],["mat-header-cell","","mat-sort-header","patient_name",4,"matHeaderCellDef"],["matColumnDef","Description"],["mat-header-cell","","mat-sort-header","patient_id",4,"matHeaderCellDef"],["matColumnDef","Action"],["matColumnDef","Review"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"id",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","","mat-sort-header","patient_name"],["mat-header-cell","","mat-sort-header","patient_id"],["aria-label","Select an option","color","primary",3,"change","value"],[1,"form-field",3,"keydown.enter","value"],["mat-header-row",""],["mat-row","",3,"id"],["mat-dialog-title",""],["align","end"],["mat-button","","mat-dialog-close","","color","primary"]],template:function(i,n){if(i&1){let m=S();r(0,"div",2)(1,"div",3)(2,"div",4)(3,"form",5)(4,"div",6)(5,"div",7)(6,"div",8)(7,"div",9)(8,"mat-label",10),s(9,"Patient Name"),o(),r(10,"mat-form-field",11),f(11,"input",12),o(),u(12,Ht,2,0,"mat-error",13)(13,Bt,2,0,"mat-error",13)(14,jt,2,0,"mat-error",13),o()(),r(15,"div",8)(16,"div",9)(17,"mat-label",10),s(18,"Patient Id"),o(),r(19,"mat-form-field",11),f(20,"input",14),o(),u(21,Qt,2,0,"mat-error",13)(22,Jt,2,0,"mat-error",13)(23,Xt,2,0,"mat-error",13)(24,Yt,2,0,"mat-error",13),o()(),r(25,"div",15)(26,"div",16)(27,"p",17),s(28,"Patient Type"),o(),r(29,"mat-radio-group",18)(30,"mat-radio-button",19),s(31,"In Patient"),o(),r(32,"mat-radio-button",20),s(33,"Out Patient"),o()()()(),r(34,"div",15)(35,"div",16)(36,"p",17),s(37,"Audio File"),o(),r(38,"mat-radio-group",21),v("change",function(y){return g(m),C(n.enableOptions(y))}),N(39,Kt,2,2,"mat-radio-button",22,A),o()()()(),r(41,"div",7)(42,"div",23),u(43,te,9,3,"div",24)(44,ne,10,11)(45,ae,2,0,"mat-error",13),o()()(),r(46,"div",7)(47,"div",7)(48,"div",25)(49,"button",26),v("click",function(){return g(m),C(n.submitPatientDetails())}),r(50,"mat-icon",27),s(51,"settings"),o(),s(52,"Generate Transcript"),o()()(),r(53,"div",28)(54,"div",29)(55,"div",7)(56,"div",30)(57,"mat-label",10),s(58,"Transcript"),o()(),r(59,"div",31),u(60,re,2,0,"a",32),r(61,"button",33),v("click",function(){return g(m),C(n.copyToClipBoard("transcript"))}),f(62,"img",34),o()()(),f(63,"div",35),o()(),r(64,"div",28)(65,"div",36)(66,"div",7)(67,"div",30)(68,"mat-label",37),s(69,"Optimized Transcript "),o()()(),r(70,"div",38),f(71,"div",39),u(72,oe,1,0,"div",40),o()()()(),r(73,"div",41)(74,"div",42)(75,"p",17),s(76,"Select Transcript"),o(),r(77,"mat-radio-group",43),v("change",function(y){return g(m),C(n.selectTranscript(y))}),r(78,"mat-radio-button",19),s(79,"Transcript"),o(),r(80,"mat-radio-button",20),s(81,"Optimized Transcript"),o()()(),r(82,"div",44)(83,"div",16)(84,"mat-label",10),s(85,"Template"),o(),r(86,"mat-form-field",11)(87,"mat-select",45),u(88,se,2,0),o()(),u(89,de,2,0,"mat-error",13),o()(),r(90,"div",46)(91,"button",47),v("click",function(){return g(m),C(n.generateSummary())}),r(92,"mat-icon",27),s(93,"settings"),o(),s(94,"Generate Summary"),o()()(),r(95,"div",48)(96,"div",7)(97,"div",30)(98,"mat-label",10),s(99,"Summary"),o()(),r(100,"div",31)(101,"button",49),v("click",function(){return g(m),C(n.copySummary())}),f(102,"img",34),o()()(),r(103,"mat-form-field",11),f(104,"textarea",50),o()(),r(105,"div"),u(106,Se,26,3,"div",51)(107,Ie,26,3,"div",51),o()()()()(),u(108,We,7,1,"ng-template",null,0,X)}if(i&2){let m,p,y,F,O,R,V,k,I;d(3),c("formGroup",n.patientDetailsForm),d(9),_(12,(m=n.patientDetailsForm.get("patientName"))!=null&&m.hasError("required")&&((m=n.patientDetailsForm.get("patientName"))!=null&&m.touched)?12:-1),d(),_(13,(p=n.patientDetailsForm.get("patientName"))!=null&&p.hasError("numb")&&((p=n.patientDetailsForm.get("patientName"))!=null&&p.touched)?13:-1),d(),_(14,(y=n.patientDetailsForm.get("patientName"))!=null&&y.hasError("speChar")&&((y=n.patientDetailsForm.get("patientName"))!=null&&y.touched)?14:-1),d(7),_(21,(F=n.patientDetailsForm.get("patientId"))!=null&&F.hasError("required")&&((F=n.patientDetailsForm.get("patientId"))!=null&&F.touched)?21:-1),d(),_(22,(O=n.patientDetailsForm.get("patientId"))!=null&&O.hasError("maxlength")&&((O=n.patientDetailsForm.get("patientId"))!=null&&O.touched)?22:-1),d(),_(23,(R=n.patientDetailsForm.get("patientId"))!=null&&R.hasError("speCharwithoutDash")&&((R=n.patientDetailsForm.get("patientId"))!=null&&R.touched)?23:-1),d(),_(24,(V=n.patientDetailsForm.get("patientId"))!=null&&V.hasError("space")&&((V=n.patientDetailsForm.get("patientId"))!=null&&V.touched)?24:-1),d(15),W(n.fileOptions),d(4),_(43,n.isUploadFile?43:44),d(2),_(45,(k=n.patientDetailsForm.get("audioFile"))!=null&&k.hasError("required")&&((k=n.patientDetailsForm.get("patientId"))!=null&&k.touched)?45:-1),d(4),c("disabled",n.isGenerate),d(11),_(60,n.citation&&n.citation.length?60:-1),d(3),c("innerHTML",n.transcriptValue,$)("contentEditable",n.isContentEditable),d(8),c("innerHTML",n.optimizedTranscriptValue,$)("contentEditable",n.isContentEditable),d(),_(72,n.isLoading?72:-1),d(16),_(88,n.promptTemplate&&n.promptTemplate.length?88:-1),d(),_(89,(I=n.patientDetailsForm.get("promptId"))!=null&&I.hasError("required")&&((I=n.patientDetailsForm.get("promptId"))!=null&&I.touched)?89:-1),d(2),c("disabled",n.isGenerateSummary),d(15),_(106,n.CPTCodes&&n.CPTCodes.length?106:-1),d(),_(107,n.ICDCodes&&n.ICDCodes.length?107:-1)}},dependencies:[It,K,nt,Z,tt,et,at,rt,mt,dt,lt,st,ct,pt,vt,bt,Tt,St,xt,Et,Dt,yt,Pt,wt,ht,_t,Ct,gt,Ot,Rt,Mt,ot,Ft,Vt,kt],styles:['.patientsDetailsWrapper[_ngcontent-%COMP%]{padding:24px}.patientsDetailsWrapper[_ngcontent-%COMP%]   .patientForm[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:20px;flex-direction:column}.patientsDetailsWrapper[_ngcontent-%COMP%]   .patientForm[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{flex:0 0 50%}.patientsDetailsWrapper[_ngcontent-%COMP%]   .patientCard[_ngcontent-%COMP%]{border-bottom:1px solid #b8b8b8;margin-bottom:12px}.patientsDetailsWrapper[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{width:100%}.patientsDetailsWrapper[_ngcontent-%COMP%]   .control-label[_ngcontent-%COMP%]{font-size:16px;font-weight:500;margin-bottom:8px;display:inline-block}.patientsDetailsWrapper[_ngcontent-%COMP%]   .recordAudioWrapper[_ngcontent-%COMP%], .patientsDetailsWrapper[_ngcontent-%COMP%]   .uploadFileControl[_ngcontent-%COMP%]{background-color:#c49aff30;padding:20px;border-radius:4px;border:1px solid #ddd}.patientsDetailsWrapper[_ngcontent-%COMP%]   .record-label[_ngcontent-%COMP%]{font-size:16px;font-weight:500;margin:0}.patientsDetailsWrapper[_ngcontent-%COMP%]   .record-control[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.patientsDetailsWrapper[_ngcontent-%COMP%]   .microphone-btn[_ngcontent-%COMP%]{height:50px;border:1px solid #ddd;width:50px;margin:0 4px;border-radius:50%;position:relative;display:flex;align-items:center;justify-content:center}.patientsDetailsWrapper[_ngcontent-%COMP%]   .microphone-btn[_ngcontent-%COMP%]:disabled{background-color:#ddd}.patientsDetailsWrapper[_ngcontent-%COMP%]   .microphone-btn.animate[_ngcontent-%COMP%]:after{animation:_ngcontent-%COMP%_pulse 1s infinite;border:5px solid rgba(242,79,79,.2)}.patientsDetailsWrapper[_ngcontent-%COMP%]   .microphone-btn.stopAnimate[_ngcontent-%COMP%]:after{animation:none;border:none}.patientsDetailsWrapper[_ngcontent-%COMP%]   .microphone-btn[_ngcontent-%COMP%]:after{content:"";position:absolute;width:60px;height:60px;display:block;background:transparent;border-radius:50%;z-index:-1}.patientsDetailsWrapper[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{height:50px;border:1px solid #ddd;width:50px;margin:0 4px;border-radius:50%}.patientsDetailsWrapper[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]:disabled{background-color:#ddd}.patientsDetailsWrapper[_ngcontent-%COMP%]   .generate-btn[_ngcontent-%COMP%]{background-color:#4b49ac;color:#fff;padding:16px 18px;margin:12px 0}.patientsDetailsWrapper[_ngcontent-%COMP%]   .uploadFileControl[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{padding:0;border:none}.patientsDetailsWrapper[_ngcontent-%COMP%]   .optimizedtranscriptWrapper[_ngcontent-%COMP%]   .optimizedtranscriptControl[_ngcontent-%COMP%]{position:relative}.patientsDetailsWrapper[_ngcontent-%COMP%]   .suggestionBox[_ngcontent-%COMP%], .patientsDetailsWrapper[_ngcontent-%COMP%]   .original-transcript[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:4px;overflow-y:auto;height:400px;padding:20px;position:relative}@keyframes _ngcontent-%COMP%_rotation{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1);opacity:0}to{transform:scale(1);opacity:1}}.confirmationModal[_ngcontent-%COMP%]{border-radius:24px;padding:24px}.confirmationModal[_ngcontent-%COMP%]   .ctaWrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.confirmationModal[_ngcontent-%COMP%]   .ctaWrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:0 0 50%}.confirmationModal[_ngcontent-%COMP%]   .ctaWrapper[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]{border:1px solid #4B49AC;color:#4b49ac;padding:16px 18px}.confirmationModal[_ngcontent-%COMP%]   .ctaWrapper[_ngcontent-%COMP%]   .btn-generate-summary[_ngcontent-%COMP%]{background-color:#4b49ac;color:#fff;padding:16px 18px;margin:12px 0}.summaryControl[_ngcontent-%COMP%]{border:1px solid #000;height:272px;overflow:auto;border-radius:4px;padding:20px}.original-transcript[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:4px;overflow-y:auto;height:272px;padding:20px}.loaderWrapper[_ngcontent-%COMP%]{position:relative}.loaderWrapper[_ngcontent-%COMP%]   .loader[_ngcontent-%COMP%]{width:48px;height:48px;border:8px solid #8a89c9;border-bottom-color:#fff;border-radius:50%;display:inline-block;box-sizing:border-box;animation:_ngcontent-%COMP%_rotation 1s linear infinite;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}']});let t=l;return t})();export{mi as PatientDetailsComponent};
